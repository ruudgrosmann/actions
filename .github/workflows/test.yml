name: tester
on: push
jobs:
  tester:
    runs-on: ubuntu-latest
    environment: dev
    steps:
      - name: check out repostitory
        uses: actions/checkout@v4
        with:
          ref: main
      - name: voor npm install
        shell: bash
        run: |
          echo git-ref ${{ github.ref_name }}
          echo ${{ github.workspace }}
          ls -R ${{ github.workspace }}
          ls -R ${{ github.workspace }}/.github
      - name: NPM Install
        uses: ./.github/actions/npm-install
        with:
          node_auth_token: ${{ secrets.SDU_READ_PACKAGES_GH_PAT }}
          node_version: 20.11.0
      - name: actiess
        shell: bash
        run: |
          echo home $HOME
          echo home3 ${{ vars.HOME }}
          bin/verklap "># ${{ secrets.SECRET }}"
          cat bin/tester
          node zipper.js
      - name: Send email
        uses: devellany/send-mail@v1.0.2
        with:
          host: smtp.postmarkapp.com
          port: 25
          account: ${{secrets.POSTMARK_API_TOKEN}}
          password: ${{secrets.POSTMARK_API_TOKEN}}
          sender: testsoftware
          from: informatie@sdu.nl
          subject: mail van github 1
          body: file://mail.html
          contentType: text/html
          attachments: '[{"path":"${{github.workspace}}/resultaat.zip"}]'
          to: r.grosmann@sdu.nl,r.grosmann@gmail.com
      - run: echo "üçè The status is ${{job.status}}."

